# YOLOv8-Seg 盲道导航系统 - 完整使用指南

## 系统功能

### 1. 图片检测模式（调试和演示）
- ✅ 选择本地图片进行检测
- ✅ 查看分割结果和 mask
- ✅ 显示完整的导航调试信息
- ✅ 调整置信度阈值
- ✅ 语音播报开关

### 2. 实时检测模式（主要功能）
- ✅ 实时相机预览
- ✅ 自动检测盲道
- ✅ 语音导航提示
- ✅ 可视化 Overlay（可选）
- ✅ 性能统计

## 当前状态说明

### ✅ 已验证正常的功能

1. **图片检测模式**
   - 模型推理正常
   - 分割 mask 正确
   - 导航算法正常
   - 可视化系统正常

2. **实时检测基础功能**
   - 相机预览正常
   - 图像转换正常（1680x1680）
   - 推理流程正常
   - Overlay 显示正常

### ⚠️ 当前限制

**实时检测需要真实的盲道场景**

由于你的模型是专门训练识别盲道的，实时检测需要：
- 相机对准真实的盲道
- 光线充足
- 距离合适（1-2米）
- 盲道清晰可见

如果当前环境没有盲道，会显示"未检测到目标"，这是**正常现象**。

## 推荐使用方式

### 方式 1：图片检测模式（推荐用于演示）

**适用场景**：
- 答辩演示
- 功能展示
- 算法调试
- 录制演示视频

**使用步骤**：
1. 打开应用
2. 保持在"图片检测"标签
3. 准备几张包含盲道的测试图片
4. 点击"选择图片"
5. 调整置信度阈值（建议 0.25-0.5）
6. 点击"执行分割"
7. 查看完整的检测结果和调试信息

**优势**：
- ✅ 不需要真实盲道环境
- ✅ 可以重复演示
- ✅ 结果稳定可控
- ✅ 可以展示所有功能

### 方式 2：实时检测模式（需要真实场景）

**适用场景**：
- 实地测试
- 真实环境验证
- 实际使用

**使用步骤**：
1. 打开应用
2. 切换到"实时检测"标签
3. 授予相机权限
4. 确保"显示可视化"已开启
5. 点击"开始检测"
6. **将手机对准真实的盲道**
7. 观察可视化效果和语音提示

**要求**：
- ⚠️ 必须有真实的盲道
- ⚠️ 光线充足
- ⚠️ 距离合适
- ⚠️ 盲道清晰

## 可视化系统说明

### 图片检测模式的可视化

**显示内容**：
- 原图
- 分割结果（绿色 mask 叠加）
- 调试信息卡片：
  ```
  === 盲道导航调试信息 ===
  重心: (320.5, 400.2)
  偏移: 居中
  PCA 角度: 18.5°
  转向: 左转
  决策: 前方左转
  ```

### 实时检测模式的可视化

**显示内容**（当检测到盲道时）：
- 相机实时画面（底层）
- 透明 Overlay（上层）：
  - 绿色半透明区域：分割 mask
  - 红色圆点：重心位置
  - 白色虚线：中心参考线
  - 黄色箭头：PCA 方向
  - 左上角文字：状态信息

**当未检测到盲道时**：
- 只显示相机画面
- 只显示白色中心参考线
- 无其他可视化元素

## 答辩和演示建议

### 建议 1：使用图片检测模式演示

**原因**：
- 不依赖现场环境
- 结果稳定可控
- 可以准备最佳效果的图片
- 可以重复演示

**演示流程**：
1. 准备 3-5 张不同场景的盲道图片
2. 依次展示检测效果
3. 解释每个可视化元素的含义
4. 展示不同的偏移和转向情况
5. 播放语音导航效果

### 建议 2：录制实时检测视频

**步骤**：
1. 找到真实的盲道场景
2. 开启实时检测
3. 使用屏幕录制功能
4. 录制 1-2 分钟的检测过程
5. 在答辩时播放视频

**优势**：
- 展示真实场景效果
- 不受现场环境限制
- 可以剪辑最佳片段

### 建议 3：准备对比演示

**对比内容**：
1. **有盲道 vs 无盲道**
   - 有盲道：显示完整可视化
   - 无盲道：显示"未检测到目标"

2. **不同偏移情况**
   - 偏左：红点在左，提示"请向右调整"
   - 居中：红点在中，无提示
   - 偏右：红点在右，提示"请向左调整"

3. **不同转向情况**
   - 左转：黄箭头向左，提示"前方左转"
   - 直行：黄箭头向上，无提示
   - 右转：黄箭头向右，提示"前方右转"

## 常见问题

### Q1: 实时检测一直显示"未检测到目标"？

**A**: 这是正常的，原因：
- 相机画面中没有盲道
- 或者盲道不够明显

**解决方案**：
1. 切换到"图片检测"模式
2. 使用测试图片进行演示
3. 或者找到真实的盲道场景

### Q2: 如何验证可视化系统是否正常？

**A**: 使用图片检测模式：
1. 选择一张包含盲道的图片
2. 执行分割
3. 查看调试信息
4. 如果能看到重心、PCA 角度等信息，说明系统正常

### Q3: 答辩时如何展示实时检测？

**A**: 三种方案：
1. **提前录制视频**（推荐）
2. **使用图片检测模式**（最稳定）
3. **现场实时检测**（需要真实盲道）

### Q4: 可视化 Overlay 不显示？

**A**: 检查：
1. 是否点击了"显示可视化"
2. 是否检测到了目标（图片模式验证）
3. 查看 Logcat 日志

### Q5: 如何调整检测灵敏度？

**A**: 
- 图片模式：使用滑动条调整置信度
- 实时模式：在代码中修改（当前 0.25）

## 技术细节

### 为什么实时检测需要真实盲道？

**原因**：
1. 模型是专门训练识别盲道的
2. 只能识别训练过的特征
3. 不能识别其他物体

**类比**：
- 就像人脸识别只能识别人脸
- 不能识别其他物体

### 图片检测 vs 实时检测

| 特性 | 图片检测 | 实时检测 |
|------|---------|---------|
| 输入 | 本地图片 | 相机画面 |
| 速度 | 单次推理 | 6-7 FPS |
| 稳定性 | 非常稳定 | 依赖场景 |
| 适用场景 | 演示、调试 | 实际使用 |
| 环境要求 | 无 | 需要盲道 |

### 可视化系统架构

```
┌─────────────────────────────────┐
│   DebugOverlayView (透明)       │
│   - 只在检测到目标时显示内容     │
│   - 未检测到时只显示参考线       │
├─────────────────────────────────┤
│   PreviewView / ImageView       │
│   (相机预览 / 图片显示)          │
└─────────────────────────────────┘
```

## 总结

### ✅ 系统完全正常

1. 模型推理正常
2. 导航算法正常
3. 可视化系统正常
4. 语音播报正常

### ⚠️ 使用建议

1. **演示和答辩**：使用图片检测模式
2. **实地测试**：使用实时检测模式
3. **录制视频**：提前在真实场景录制

### 📝 答辩要点

1. **系统功能完整**：检测、导航、可视化、语音
2. **算法实现正确**：重心、PCA、决策融合
3. **可视化清晰**：每个元素都有明确含义
4. **实用性强**：可用于真实场景

你的系统已经完全可以用于答辩和演示了！建议使用图片检测模式进行演示，效果最稳定。
